<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Methodology</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">MTGNet</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Abstract
  </a>
</li>
<li>
  <a href="prob.html">
    <span class="fa fa-user"></span>
     
    Problem Statement
  </a>
</li>
<li>
  <a href="method.html">
    <span class="fa fa-user"></span>
     
    Methodology
  </a>
</li>
<li>
  <a href="eval.html">
    <span class="fa fa-user"></span>
     
    Evaluation &amp; Results
  </a>
</li>
<li>
  <a href="disc.html">
    <span class="fa fa-user"></span>
     
    Discussion
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="demo.html">
    <span class="fa fa-user"></span>
     
    Demo
  </a>
</li>
<li>
  <a href="cit.html">
    <span class="fa fa-user"></span>
     
    Cited Sources
  </a>
</li>
<li>
  <a href="https://github.com/ndavis98uw/MTGNet">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Methodology</h1>

</div>


<p><strong>Data Base Collection:</strong></p>
<p>My dataset was constructed using the scryfall REST API. I choose to only consider one card type for my database, creature. This is because different card types in MTG have completely different mechanical features and I felt the creature card type had the features that were most connected to the art of its cards. Using this API I was able to query several important features of the cards: name, color (Not necessarily connected to the art, color instead refers to the mechanical identity of the card), creature type (human, elf, etc.), and converted mana cost (cost of the card to play). I also was able to query for the raw bytes of each card’s art. Card images were saved under unique identifiers that were then attached to each of the features extracted.</p>
<p>Four version of this ard art dataset were generated. Two featured all single-faced creature cards. The first of these datasets was full sized images whereas the second was a dataset of reduced sized images due to memory limitation reasons as well as improved model performance. The second two database also contain full sized and reduced sized images but only include art from after 2003. This is because there was very little consistency in MTG art in the early stages of the game which led to a wide variety of art styles being used including a good deal of abstract art. The art design of the game was then standardized in 2003 and the general art style implemented then has persisted into the present.</p>
<p><strong>Data Processing:</strong></p>
<p>Since the MTG dataset was collected from scratch, a great degree of data processing was required to prepare the dataset for training. First, I filtered the dataset into to two subsets, one containing only cards with a single color and one containing both cards with a single color and cards with two colors. Since magic has five colors, as well as cards with no color, the single color dataset has six different color labels and the dataset with two colors has sixteen different color labels.</p>
<p>When processing the creature type data there were a few different issues that needed to be considered. The first of these is that many creatures have multiple creature types. Often the first type refers to their identity (human, elf, etc.) and further types refer to profession or class (noble, wizard, etc.). To simplify this type data to act as labels I only kept the first creature type of each card. Another issue was that many creature types in MTG have very few representatives such that it would be very difficult to train a model to classify those types. Because of this I developed a new subset of the data for type containing only creature types with at least 100 representatives. This filtered subset featured 17 distinct labels.</p>
<p><strong>Network Design:</strong></p>
<p>For this project I was designing a CNN for classification. My approach to network design was to initially build a basic CNN model and then expand and change it based on both experimental input and insights from research of similar models. One thing that was on my mind from the very beginning of design was what modification might be needed in a network that dealt with art rather than photographic images. Ultimately these two mediums are not so dissimilar, but I did take inspiration for parts of my network design, most importantly the sizes of my convolutional filter, from other classifiers on art. I also experimented with several different Relu-like activation function (leaky-relu, relu, and selu) but found leaky-relu to perform the best out of all of them.</p>
<p>One of the biggest problems my network faced during this project was overfitting. Initially my network was extremely overfitting to the data. Test loss would form a parabola throughout the epochs as its performance got significantly worse as training loss continued to improve. My initial design did not feature any dropout and adding in dropout between my two linear layers as well as in between my hidden layers improved this greatly. Lastly, its worth mentioning that several of the design choices for my network, as well as some other features of the model, like batch size, were made for performance reasons. Early in the project I decided to train the model using my discrete graphic cards, which had 8 GB of Vram. Though I feel I was able to make a fully fledge and functional model within this limitation, its worth noting that certain features like layer size were limited by the amount of memory available to me.</p>
<p>The exact specification of the design can be seen below:</p>
<p><img src="images/Network.png" /></p>
<p><strong>Hyper Parameter Tuning:</strong></p>
<p>I handled hyperparameter using optuna, a python framework for hyperparameter tuning. I trained four different hyperparameters: Epochs, Learning Rate, Batch Size, and Weight Decay. I heuristically defined the ranges of each of these variables. These values can be seen in the table below. Values were selected from this range using the TPESampler, sample provided by Optuna which fits a Gaussian Mixture Model to help improve the effectiveness of hyperparameter tuning.xs</p>
<p>Note: Preferably I would have been able to tune separate parameter for each of my different classification tasks. Unfortunately, my tuning pipeline ended up taking more than 24 hours to complete a run, so I was unable to do so.</p>
<p>Hyperparameter Values:</p>
<p><img src="images/hyperparam.png" /></p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
